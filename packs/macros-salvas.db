{"name":"Bananas","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"modules/bananas/media/img/banana.png","command":"let myContent = `<style>\n    /* Adicionando estilo ao botão */\n    button {\n        cursor: pointer;\n    }\n\n    /* Adicionando estilo ao input de texto */\n    #bananas input[type=text] {\n        padding: 12px 20px;\n        border: 1px solid #9D0C051;\n        border-radius: 4px;\n        box-sizing: border-box;\n        background-color:rgba(1,0,0,0.1);\n        margin-top:2px;\n        margin-left: 2px;\n        text-align: center;\n        font-size: x-small;\n        font-style: italic;\n    }\n\n    /* Criando o grid */\n    .grid-container {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        grid-gap: 10px;\n        border-color: rgba(154,0,0,0.2);\n    }\n\n    fieldset {\n        background-color:rgba(1,0,0,0.1);\n    margin-top: 20px;\n            border: 1px solid #9D0C051;\n        border-radius: 4px;\n\n}\n\nlegend {\n  color: rgba(1,0,0,1);\n  padding: 5px 10px;\n          border: 1px solid #9D0C051;\n        border-radius: 4px;\n}\n\n</style>\n\n<div class=\"grid-container\">\n\n    <div>\n        <button id=\"button1\">has</button>\n        <input type=\"text\" id=\"input1\" placeholder=\"Item name\">\n    </div>\n\n    <div>\n        <button id=\"button2\">skill</button>\n        <input type=\"text\" id=\"input2\" placeholder=\"Skill name\">\n    </div>\n\n     <div>\n        <button id=\"button5\">journal</button>\n        <input type=\"text\" id=\"input5\" placeholder=\"Journal name\">\n    </div>\n\n    <div>\n        <button id=\"button6\">odds</button>\n        <input type=\"text\" id=\"input6\" placeholder=\"Success chance\">\n    </div>\n\n    \n    <div>\n        <button id=\"button8\">setsize</button>\n        <input type=\"text\" id=\"input8\" placeholder=\"Size\">\n    </div>\n\n    <div>\n        <button id=\"button9\">lights</button>\n        <input type=\"text\" id=\"input9\" placeholder=\"on|off\">\n    </div>\n    <div>\n        <button id=\"button10\">new button 2</button>\n        <input type=\"text\" id=\"input10\" placeholder=\"Input for new button 2\">\n    </div>\n    <div>\n        <button id=\"button11\">new button 3</button>\n        <input type=\"text\" id=\"input11\" placeholder=\"Input for new button 3\">\n    </div>\n    <div>\n        <button id=\"button12\">ra</button>\n        <input type=\"text\" id=\"input12\" placeholder=\"Insert NH\">\n    </div>\n</div>\n\n\n\n  <fieldset>\n    <legend>Personalia:</legend>\n<div class=\"grid-container\">\n\n    <div>\n        <button id=\"button4\">showimage</button>\n    </div>\n  <div>\n        <button id=\"button3\">dodge</button>\n    </div>\n\n    <div>\n        <button id=\"button7\">disads</button>\n    </div>\n<div>\n        <button id=\"button13\">sight</button>\n    </div>\n    <div>\n        <button id=\"button14\">inv</button>\n    </div>\n    </div>\n  </fieldset>\n\n\n\n`\n\nnew Dialog({\n    title: \"YES! We have Bananas!\",\n    content: myContent,\n    buttons: {},\n    render: async (html) => listeners(html),\n}, {\n    resizable: true,\n    id: \"bananas\",\n    width: 350,\n}).render(true);\n\n\n\nasync function listeners(html) {\n\n    // Button 1 listener\n    html.find(\"#button1\").on(\"click\", () => {\n        let input1 = html.find(\"#input1\").val();\n        GURPS.executeOTF(\"/has \" + input1);\n    });\n\n    // Button 2 listener\n    html.find(\"#button2\").on(\"click\", () => {\n        let input2 = html.find(\"#input2\").val();\n        GURPS.executeOTF(\"/skill \" + input2);\n    });\n\n    // Button 3 listener\n    html.find(\"#button3\").on(\"click\", () => {\n        let input3 = html.find(\"#input3\").val();\n        GURPS.executeOTF(\"/dodge \" + input3);\n    });\n\n    // Button 4 listener\n    html.find(\"#button4\").on(\"click\", () => {\n        let input4 = html.find(\"#input4\").val();\n        GURPS.executeOTF(\"/showimage \" + input4);\n    });\n\n    // Button 5 listener\n    html.find(\"#button5\").on(\"click\", () => {\n        let input5 = html.find(\"#input5\").val();\n        GURPS.executeOTF(\"/journal \" + input5);\n    });\n\n    // Button 6 listener\n    html.find(\"#button6\").on(\"click\", () => {\n        let input6 = html.find(\"#input6\").val();\n        GURPS.executeOTF(\"/odds \" + input6);\n    });\n\n    // Button 7 listener\n    html.find(\"#button7\").on(\"click\", () => {\n        let input7 = html.find(\"#input7\").val();\n        GURPS.executeOTF(\"/disads \" + input7);\n    });\n\n    // Button 8 listener\n    html.find(\"#button8\").on(\"click\", () => {\n        let input8 = html.find(\"#input8\").val();\n        GURPS.executeOTF(\"/setsize \" + input8);\n    });\n\n    // Button 9 listener\n    html.find(\"#button9\").on(\"click\", () => {\n        let input8 = html.find(\"#input9\").val();\n        GURPS.executeOTF(\"/lights \" + input8);\n    });\n        // Button 12 listener\n    html.find(\"#button12\").on(\"click\", () => {\n        let input12 = html.find(\"#input12\").val();\n        GURPS.executeOTF(`/ra  ${input12}`);\n    });\n  // Button 13 listener\n    html.find(\"#button13\").on(\"click\", () => {\n        let input13 = html.find(\"#input13\").val();\n        GURPS.executeOTF(`/sight`);\n    });\n\n    // // Button 14 listener\n    // html.find(\"#button14\").on(\"click\", () => {\n    //     let input12 = html.find(\"#input14\").val();\n    //     GURPS.executeOTF(`/inv`);\n    // });\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.RTc3si8EOLbuOVnb"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1674796667020,"modifiedTime":1677118260657,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"nyifjn0cVJ2gZNU2"}
{"name":"Pegando fogo","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/magic/fire/flame-burning-tree-bush.webp","command":"let tokenD = canvas.tokens.controlled[0];\nif (!tokenD) { return; }\nconst effects = Sequencer.EffectManager.getEffects({ name: \"*torch-wood*\", object: tokenD });\n\nif (effects.length) {\n    Sequencer.EffectManager.endEffects({ name: \"*torch-wood*\", object: tokenD });\n    Sequencer.EffectManager.endEffects({ name: \"*torch-fume*\", object: tokenD });\n    Sequencer.EffectManager.endEffects({ name: \"*torch-flame*\", object: tokenD });\n} else {\n\n    let tokenD = canvas.tokens.controlled[0];\n\n    new Sequence()\n        .effect()\n        .file(\"jb2a.flames.02.orange\")\n        .scale(0.6)\n        .atLocation(tokenD)\n        .zeroSpriteRotation(true)\n        .attachTo(tokenD, { bindVisibility: false })\n        .name(\"torch-wood\")\n        .persist()\n        .spriteOffset({ x: 0, y: -60 })\n        .zeroSpriteRotation(true)\n        .play()\n}\n\n\nconst cDimLight = 3;\nconst cBrightLight = 1;\nconst cAnimationType = \"torch\";\nconst cAngle = 360;\n\n\nlet dataUpdate = {\n    'light.angle': !token.data.angle ? cAngle : 0,\n    'light.dim': !token.data.light.dim ? cDimLight : 0,\n    'light.bright': !token.data.light.bright ? cBrightLight : 0,\n    'light.color': '#FFBE33',\n    'light.alpha': 0.2,\n    'light.animation': { \"type\": cAnimationType, \"speed\": 9, \"intensity\": 7 }\n};\ntokenD.document.update(dataUpdate);","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.oZfdYr2pOLMHFZiw"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1676381440277,"modifiedTime":1677118264803,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"hx8DC2VR8NOGkTrv"}
{"name":"Jogo do Buda","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"worlds/japao/img/wooden%20Budha.webp","command":"let actors = canvas.tokens.controlled.map((i) => i.actor);\nlet actorData = [];\nfor (const actor of actors) {\n    let data = GURPS.lastTargetedRolls[actor.id];\n    actorData.push({\n        name: actor.name,\n        target: data.finaltarget,\n        skill: data.thing,\n        margin: data.margin\n    });\n}\nconsole.log(actorData)\nlet winner = { margin: -Infinity };\n\nfor (const actor of actorData) {\n    if (actor.margin > winner.margin) {\n        winner = actor;\n    }\n}\n\nlet diff = winner.margin;\n\n// Check if all margins are equal\nlet isDraw = actorData.every(a => a.margin === winner.margin);\nif (isDraw) {\n    ChatMessage.create({ \n        content: `Empate! Cada um tirou ${winner.margin}`, \n        speaker: { alias: \"Akihito Otomi\" } \n    });\n} else {\n    for (const actor of actorData) {\n        if (actor.margin !== winner.margin) {\n            diff -= actor.margin;\n        }\n    }\n    ChatMessage.create({ \n        content: `${winner.name} rolou ${winner.skill} e venceu por ${diff}`, \n        speaker: { alias: \"Akihito Otomi\" } \n    });\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.4LdBHBGWHQIXgeOV"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1674771147398,"modifiedTime":1677118275786,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"xoVHykstmaf576ez"}
{"name":"New Macro","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"worlds/japao/svg/sword_katana_japanese_weapon_samurai_traditional_warrior_japan_icon_127295.png","command":"const myContent = `\n  <style>\n  .callheader {\n      background-color: black;\n      font-family: Roboto, sans-serif;\n      color: white;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 50px;\n      height: 50px;\n      margin-bottom: 10px;\n      border-radius: 0.375rem;\n      font-size: 18px;\n      text-decoration: none;\n    }\n    div#homePage {\n      margin-top:25px;\n    }\n  </style>\n    <div class=\"callheader\">Treasure Generator</div>\n\n  <br>\n  <form>\n    <div class=\"form-group\">\n      <label>Valor Máximo</label>\n      <div class=\"form-fields\">\n        <input id=\"valuInput\" type=\"number\" name=\"valuInput\">\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <label>Valor Mínimo</label>\n      <div class=\"form-fields\">\n        <input id=\"minValueInput\" type=\"number\" name=\"minValueInput\">\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <label>Quantidade de itens</label>\n      <div class=\"form-fields\">\n        <input id=\"quantityInput\" type=\"number\" name=\"quantityInput\">\n      </div>\n    </div>\n    <div class=\"form-group\">\n      <label>Folder</label>\n      <div class=\"form-fields\">\n        <input id=\"folder\" type=\"text\" name=\"folder\">\n      </div>\n    </div>\n    </form>\n\n  <div id=\"homePage\"></div>\n  \n  <button class=\"banana-set-size\"  role=\"button\">Banana</button>\n`;\n\nnew Dialog({\n  title: \"GURPS\",\n  content: myContent,\n  buttons: {},\n  render: async (html) => listeners(html),\n},{\n    width: 350, \n    height: 800,\n    resizable: true, \n}).render(true);\n\nasync function listeners(html) {\n\n  html.click(async function (event) {\n    if (event.target.className === \"banana-set-size\") {\n        const itemFolder = html.find(\"#folder\").val();\n\n               const folder = game.folders.getName(itemFolder).contents;\n\nlet count = 0;\nconst items = folder.reduce((acc, item) => {\n  const valuInput = html.find(\"#valuInput\").val();\n  const minValueInput = html.find(\"#minValueInput\").val();\n  const quantityInput = html.find(\"#quantityInput\").val();\n\n  if (item.system.eqt.cost <= valuInput && item.system.eqt.cost >= minValueInput && count < quantityInput) {\n    count++;\n\n\nconst meleeTem = Object.values(item.system.melee).map(e => e.otf);\nconst rangedTem = Object.values(item.system.ranged).map(e => e.otf);\n\nconst allTem = meleeTem.concat(rangedTem);\n\nconst hasSpear = allTem.some(array => array.includes('Spear'));\nconst hasBow = allTem.some(array => array.includes('Bow'));\nconst hasKatana = allTem.some(array => array.includes('Broadsword'));\nconst hasKusari = allTem.some(array => array.includes('Kusari'));\n\nlet imagePath;\nif (hasSpear) {\n  imagePath = 'worlds/japao/svg/spear.png';\n} else if (hasBow) {\n  imagePath = 'worlds/japao/svg/bow.png';\n} else if (hasKatana) {\n  imagePath = 'worlds/japao/svg/sword_katana_japanese_weapon_samurai_traditional_warrior_japan_icon_127295.png';\n} else if (hasKusari) {\n  imagePath = 'worlds/japao/svg/kusari.png';\n} else {\n  imagePath = item.img;\n}\n\n    return acc + `<div style=\"line-height: 1.6;\">Name: ${item.link}<br> \n                                 <div class=\"img\" style=\"float:right; height: 50px; width:50px;\"><img src=\"${imagePath}\"></div>\n\n                       Cost: <em>$${item.system.eqt.cost}</em> <br> \n\n                       Weight: <em>${item.system.eqt.weight}lbs</em><br>\n                       Page:<span class=\"pdflink\" onclick=\"GURPS.executeOTF('/r [PDF:${item.system.eqt.pageref}]')\">${item.system.eqt.pageref}</div><hr>`;\n  }\n    \n  return acc;\n}, \"\");\n\nconst homePage = html.find(\"#homePage\");\nhomePage.html(TextEditor.enrichHTML(items));\n\n    }\n  });\n\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.wP063clYUhaX9iym"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1675767692995,"modifiedTime":1677118287350,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"6xiSfx33kxwrF5Wu"}
{"name":"Open Journal","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/svg/dice-target.svg","command":"const uuid = \"JournalEntry.nPjmlN3T8zkJEK77\";\nconst j = await fromUuid(uuid);\nif(j.sheet.rendered) return j.sheet.close();\nelse return j.sheet.render(true,  {width: 700});","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.bhzYC0eBKFUniYUt"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1673264105143,"modifiedTime":1677118297846,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"cTHJENAzcib4rXPz"}
{"name":"Buttons","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/containers/chest/chest-reinforced-steel-red.webp","command":"const managerType = \"Helper\";\n\n(() => {\n  const macros = [\n    \"Dodge\",\n    \"Extra Effort\"\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  macros.forEach((str) => {\n    let macro = game.macros.getName(str);\n    if (!macro) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#GURPScs .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #GURPScs header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#GURPScs .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #GURPScs .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${macro.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.macros.getName(str).execute();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"GURPScs\" }\n  ).render(true);\n})();","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.NxGH31Y7v3nKh2jD"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1672382055148,"modifiedTime":1677118308763,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"FBEQ4JOwzHrexa47"}
{"name":"Macros Folder","type":"script","author":"UdpG6vh58jnwUX8q","img":"icons/containers/boxes/crate-heavy-yellow.webp","scope":"global","command":"const managerType = \"Macros Folder\";\n\n(() => {\n  const macros = [\n    \"Random Treasure Generator\",\n    \"Instant Defaults\",\n    \"Tables Folder\",\n    \"First Aid Calculator\",\n    \"Falling Calculator\",\n    \"Throwing Calculator\",\n    \"Sight Togle\",\n    \"Fatigue\",\n    \"Sight Toggle\",\n    \"Sight Adjustment\",\n    \"ReactionRoll\",\n    \"Hiking Calculator\"\n\n\n  ];\n\n  let buttons = {},\n    dialog,\n    content = `<div sytle=\"display:flex;text-align:center;><h2>Choose Macro</h2></div>`;\n\n\n  macros.forEach((str) => {\n    let macro = game.macros.getName(str);\n    if (!macro) return;\n\n    buttons[str] = {\n      label: `\n       \n<style>\n#GURPScs .window-content {\n    background-image: url('systems/gurps/icons/hex2.webp');\n        background-color: #353434;\n        display: inline-block;\n          width: 100%;\n\n\n  }\n\n  \n\n  #GURPScs header {\n    font-family: Roboto;\n    background-color: #353434;\n    border-radius: 0;\n    border: none;\n    margin-bottom: 2px;\n    font-size: .75rem;\n  }\n\n#GURPScs .dialog-button {\n  border: 1px solid #18181a;\n  color: #18181a;\n  font-size: 15px;\n  line-height: 15px;\n  padding: 5px 5px 5px;\n  width: 100%;\n  height: 100%;\n  cursor: cell;\n  background: #807f7f;\n  border-radius: 18px;\n  margin-bottom: 2px;\n      }\n\n    #GURPScs .dialog-button:hover {\n  background-color: #353434; /* Green */\n  color: white;\n    box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);\n    }\n\n      </style> \n         <div style=\"display:flex;flex-direction:row;justify-content:center;align-items:center;\">\n          \n        <div style=\"display:flex;justify-content:left;flex-grow:1;\">\n        <img src=\"${macro.img}\" width=\"50\" height=\"50\" style=\"background-color:#5c5c5c;;border-radius: 10px;margin: 3px 3px 3px;\"/></div>\n          <source src=\"/sounds/pop.mp3\" type=\"audio/mpeg\">\n\n        <div style=\"display:flex;justify-content:left;flex-grow:1\"><label>${str}</label></div>\n        </div>\n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        `,\n      callback: () => {\n        game.macros.getName(str).execute();\n        dialog.render(true);\n      },\n    };\n  });\n  dialog = new Dialog(\n    { title: `${managerType}`, content, buttons },\n    { id: \"GURPScs\" }\n  ).render(true);\n})();","flags":{"core":{"sourceId":"Macro.ul71YhG3o9fguYNU"},"cf":{"id":"temp_pn0x3le0bx"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1671892582553,"modifiedTime":1677118311710,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"J7Yis0szlQAw11CG"}
{"name":"New Macro","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"worlds/japao/img/zumb.jpg","command":"const myContent = `<style>\n    .callheader {\n      background-color: black;\n      font-family: Roboto, sans-serif;\n      color: white;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 50px;\n      height: 50px;\n      margin-bottom: 10px;\n      border-radius: 0.375rem;\n      font-size: 18px;\n      text-decoration: none;\n    }\n      \n      #tracker .input-field {\n        position: absolute;\n        width: 60px;\n        height: 25px;\n        background-color: white;\n        opacity: 0.8;\n        box-shadow: rgba(0, 0, 0, 1) 8px 8px 20px, rgba(0, 0, 0, 0.8) 8px 8px 14px; \n            font-size: 18px;\n    font-weight: bold;\n    border: none;\n      text-align: center;\n\n         }\n         \n       \n      #tracker .banana-set-size {\n       position: absolute;\n        bottom: 10px;\n  transform: translateY(150%);\n        width: 200px;\n        right: 25%;\n\ntransform: translateY(150%);\n\n\n\n}\n\n    #tracker .window-content {\n        display: inline-block;\n        background-image: url('worlds/japao/img/zumb.jpg');\n        background-size: cover;\n\n    }\n        \n  </style>\n <div id=\"window-content\">\n\n\n<!-- CABEÇA -->\n\n      <input type=\"text\" class=\"input-field\" id=\"cabeca\"\n             style=\"top: 60px; left: 50px;\">\n    \n      <input type=\"text\" class=\"input-field\" id=\"pescoco\"\n             style=\"top: 120px; left: 50px;\">\n\n<!-- LADO PEITO-->    \n      \n      <input type=\"text\" class=\"input-field\" id=\"peito\"\n             style=\"top: 180px; left: 340px;\">             \n\n<!-- LADO DIREITO  BRAÇOS-->    \n      \n      <input type=\"text\" class=\"input-field\" id=\"bdireito\"\n             style=\"top: 260px; left: 50px;\">\n      <input type=\"text\" class=\"input-field\" id=\"mesquerdo\"\n             style=\"top: 380px; left: 50px;\">\n\n<!-- LADO ESQUERDO  BRAÇOS-->    \n      \n      <input type=\"text\" class=\"input-field\" id=\"besquerdo\"\n             style=\"top: 260px; left: 340px;\">\n      <input type=\"text\" class=\"input-field\" id=\"mdireito\"\n             style=\"top: 380px; left: 340px;\">\n        \n<!-- LADO DIREITO  PERNA-->        \n          \n      <input type=\"text\" class=\"input-field\" id=\"pdireito\"\n             style=\"top: 500px; left: 50px;\">\n      <input type=\"text\" class=\"input-field\" id=\"fdireito\"\n             style=\"top: 620px; left: 50px;\">\n\n<!-- LADO ESQUERDO  PERNA-->        \n          \n      <input type=\"text\" class=\"input-field\" id=\"pesquerdo\"\n             style=\"top: 500px; left: 340px;\">\n      <input type=\"text\" class=\"input-field\" id=\"fesquerdo\"\n             style=\"top: 620px; left: 340px;\">\n<button class=\"banana-set-size\" role=\"button\">Banana</button>\n    </div>\n\n    </div>\n\n  <br>\n\n`;\nconst name = GURPS.LastActor.name\nconst macro = GURPS.LastActor;\nconst hpMax = GURPS.LastActor.system.HP.max\nnew Dialog({\ntitle: `Undead - ${name}`,\n    content: myContent,\n    buttons: {},\n    render: async (html) => listeners(html)\n}, {id: \"tracker\",\n    width: 420, // default \"auto\" and cant go narrower than 200\n    height: 700, // default \"auto\"\n}).render(true);\n\nasync function listeners(html) {\n  const ids = [\"cabeca\", \"pescoco\", \"peito\", \"bdireito\", \"mesquerdo\", \"besquerdo\", \"mdireito\", \"pdireito\", \"fdireito\", \"pesquerdo\", \"fesquerdo\"];\nfor (const id of ids) {\n  let bodyPart = 0;\n  if (macro.getFlag(\"world\", `zombieTracker_${id}`)) {\n    bodyPart = macro.getFlag(\"world\", `zombieTracker_${id}`);\n  }\n\n  html.find(`#${id}`).val(bodyPart);\n  //partes superiores\n  if (id === \"bdireito\" || id === \"besquerdo\" || id === \"mdireito\" || id === \"mesquerdo\") {\n    if (bodyPart >= (hpMax / 3 + 1)) {\n      html.find(`#${id}`).css(\"background-color\", \"black\") .css(\"color\", \"white\");\n    } else {\n      html.find(`#${id}`).css(\"background-color\", \"\").css(\"color\", \"\");\n    }\n  }\n    //partes inferiores\n  if (id === \"pdireito\" || id === \"pesquerdo\" || id === \"fdireito\" || id === \"fesquerdo\") {\n    if (bodyPart >= (hpMax / 2 + 1)) {\n      html.find(`#${id}`).css(\"background-color\", \"black\").css(\"color\", \"white\");\n    } else {\n      html.find(`#${id}`).css(\"background-color\", \"\").css(\"color\", \"\");\n    }\n  }\n\n  html.click(async function (event) {\n    if (event.target.className === \"banana-set-size\") {\n      bodyPart = html.find(`#${id}`).val();\n      await macro.setFlag(\"world\", `zombieTracker_${id}`, bodyPart);\n      //partes suferiores\n      html.find(`#${id}`).val(bodyPart);\n      if (id === \"bdireito\" || id === \"besquerdo\" || id === \"mdireito\" || id === \"mesquerdo\") {\n        if (bodyPart >= (hpMax / 3 + 1)) {\n          html.find(`#${id}`).css(\"background-color\", \"black\").css(\"color\", \"white\");\n\n        } else {\n          html.find(`#${id}`).css(\"background-color\", \"\").css(\"color\", \"\");\n\n       }\n        }\n         if (id === \"pdireito\" || id === \"pesquerdo\" || id === \"fdireito\" || id === \"fesquerdo\") {\n        if (bodyPart >= (hpMax / 3 + 1)) {\n          html.find(`#${id}`).css(\"background-color\", \"black\").css(\"color\", \"white\");\n\n        } else {\n          html.find(`#${id}`).css(\"background-color\", \"\").css(\"color\", \"\");\n\n       }\n        }\n      }\n    });\n  }\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.fxJANRNs24QJzOwC"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1676021114188,"modifiedTime":1677118313010,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"XIwWAJDOIGuKktYq"}
{"name":"Red Circle","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"modules/gurps-instant-defaults/packs/borders/sides.png","command":"let tokenD = canvas.tokens.controlled[0]\n    const effects = Sequencer.EffectManager.getEffects({\n        name: \"*sides*\",\n        object: tokenD,\n    });\n    if (effects.length) {\n        console.log(\"removing effect\")\n        Sequencer.EffectManager.endEffects({ name: \"*sides*\", object: tokenD });\n    }\n    else {\n        console.log(\"adding effect\")\n        new Sequence()\n            .effect()\n            .file(`modules/gurps-instant-defaults/packs/borders/sides.png`)\n            .attachTo(tokenD)\n            .scale(0.42)\n            .atLocation(tokenD)\n            .persist()\n            .name(\"sides\")\n            .elevation(-1)\n            .play();\n    }","flags":{"core":{"sourceId":"Macro.4Nzaxmr8Qmo3WFcg"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1671811905648,"modifiedTime":1677118314218,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"LPebzyuasplexHAw"}
{"name":"rules","type":"chat","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/commodities/treasure/crown-gold-laurel-wreath.webp","command":"/r [!pdf:MAN1] 800","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.iQRR4jc47KgUrkVW"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1674756165154,"modifiedTime":1677118315374,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"3TuuCVPmPuC2daUq"}
{"name":"Show Journal","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/sundries/books/book-backed-silver-gold.webp","command":"const dialogOptions = game.journal.reduce((acc, e) => acc += `<option value=${e.id}> ${e.name} </option>`, ``);\n\nconst myContent = `<style>\n    .callheader {\n      background-color: black;\n      font-family: Roboto, sans-serif;\n      color: white;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 50px;\n      height: 50px;\n      margin-bottom: 10px;\n      border-radius: 0.375rem;\n      font-size: 18px;\n      text-decoration: none;\n    }\n  </style>\n  <div class=\"callheader\">Show Journal</div>\n<form>\n    <div class=\"form-group\">\n     <label>Journal:</label>\n        <div class=\"form-fields\">\n            <select id=\"journal\">${dialogOptions}</select>\n        </div>\n    </div>\n    \n</form>\n \n      </div>\n    </form>\n  </div>\n  <br>\n  <button class=\"banana-set-size\" role=\"button\">Banana</button>\n`;\n\n\nlet error = false;\n\nif (!(game.modules.get(\"sequencer\")?.active)) {\n    error = `You need to have Sequencer installed and activated to run this macro!`;\n}\nif (error) {\n    ui.notifications.error(error);\n    return;\n}\n\nconst macro = this;\nnew Dialog({\n    title: \"GURPS\",\n    content: myContent,\n    buttons: {},\n    render: async (html) => listeners(html)\n}).render(true);\n\nasync function listeners(html) {\n\n    html.click(async function (event) {\n        if (event.target.className === \"banana-set-size\") {\n          const journalId = html.find(\"#journal\")[0].value;\n                const showJournal = game.journal.get(journalId);\n                \n                showJournal.sheet.render(true, {collapsed: true, width: 680});\n        }\n    });\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.oDEJKegxJWvOf9bc"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1673671459951,"modifiedTime":1677118316582,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"Qqh6ZGXQ2uhIImiw"}
{"name":"Clear Effects","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"systems/gurps/icons/statuses/dd-condition-unconscious.webp","command":"let effect = async function() {\n  const effect = _token.actor.effects.contents;\n  for (let i = 0; i < effect.length; i++) {\n    let condition = effect[i].data.label;\n    let status = effect[i].data.disabled;\n    let effect_id = effect[i].data._id;\n    console.log(`condition: [${condition}] status: [${status}] effect_id: [${effect_id}]`)\n    if (status === false) {\n        await _token.actor.deleteEmbeddedDocuments(\"ActiveEffect\", [effect_id]);\n    }\n  }\n}\n\neffect();","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.CvXVyYVzkKmEV9sv"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1672733501212,"modifiedTime":1677118317702,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"9rxK8yGJMHu11fj7"}
{"name":"Dinheiro","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/commodities/currency/coins-shield-sword-stack-silver.webp","command":"const myContent = `<style>\n    .callheader {\n      background-color: black;\n      font-family: Roboto, sans-serif;\n      color: white;\n      text-align: center;\n      vertical-align: middle;\n      line-height: 50px;\n      margin-bottom: 10px;\n      border-radius: 0.375rem;\n      font-size: 18px;\n      text-decoration: none;\n    }\n    #outer\n{\n    width:100%;\n    text-align: center;\n}\n.inner\n{\n    display: inline-block;\n}\n\n\n\n  </style>\n  <div class=\"callheader\">Gimme Mony PlOX</div>\n\n<form>\n    <div class=\"form-group\">\n      <label>Item</label>\n      <div class=\"form-fields\">\n        <input id=\"sizes\" type=\"text\" name=\"sizes\">\n      </div>\n    </div>\n  </form>\n <br>\n    <div id=\"outer\">\n        <input id=\"value\" type=\"number\" name=\"value\" style=\" height:27px; width:auto;\" placeholder=\"0\">\n        <div class=\"inner\"><button type=\"submit\" class=\"more\"   role=\"button\" >Increase</button></div>\n        <div class=\"inner\"><button type=\"submit\" class=\"less\"   role=\"button\" >Decrease</button></div>\n        <div class=\"inner\"><button type=\"submit\" class=\"amount\" role=\"button\"> Balance </button></div>\n    </div> \n\n`;\n\nconst macro = this;\nnew Dialog({\n  title: \"GURPS UselessMacro\",\n  content: myContent,\n  buttons: {},\n  render: async (html) => listeners(html),\n}).render(true);\n\n\nasync function listeners(html) {\n\n            const tokenD = canvas.tokens.controlled[0];\n\n        if (macro.getFlag(\"world\", \"sizes\")) html.find(\"#sizes\").val(macro.getFlag(\"world\", \"sizes\"));\n    else html.find(\"#sizes\").val(0);\n  html.click(async function (event) {\n    if (event.target.className === \"more\") {\n       const value = html.find(\"#value\").val();\n       const item = html.find(\"#sizes\").val();\n      GURPS.executeOTF(`/qty +${value} ${item}`);\n    }\n    if (event.target.className === \"less\") {\n      const value = html.find(\"#value\").val();\n      const item = html.find(\"#sizes\").val();\n\n      GURPS.executeOTF(`/qty -${value} ${item}`);\n    }\n\n    if (event.target.className === \"amount\") {\n      const size = html.find(\"#sizes\").val(); \n      await macro.setFlag(\"world\", \"sizes\", size);\n            html.find(\"#sizes\").val(size)\n        \n\n      GURPS.recurselist(\n        GURPS.LastActor.system.equipment.carried,\n        (e, key, d) => {\n                   const item = html.find(\"#sizes\").val();\n          const tokenImage = GURPS.LastActor.img\n          const itemImage = GURPS.LastActor.items.getName(item).img\n\n\n          const formatter = new Intl.NumberFormat(\"jp-bu\", {\n            style: \"currency\",\n            currency: \"JPY\",\n          });\n          if (e.name.includes(item))\n            //total = e.cost * e.count\n\n            ChatMessage.create({\n            speaker: { alias:  `Night City Bank` },\n\n              content: `\n\n \n                            \n\n                  <div style=\"\n                            align-content: center;\n                            border-radius: 0px 18px 18px 18px;\n                            background-image: url('/worlds/japao/img/buceta.webp');\n                            height: 100%;\n                            width: auto;\n                            padding:5px;\n                            font-weight: 900;\n                            border-width: 3px;\"> \n\n                  <img src='${tokenImage}' style='max-width:9em;\n                                                            border-radius:18px;\n                                                            margin-left:30%;\n                                                            margin-top:10px;\n                                                            border:none; \n                                                            filter: drop-shadow(10px 10px 0.75rem white);\n                                                            margin-bottom: 50px;\n                                                            '>\n                    \n                           \n                    <div style=\"text-align: center;\n                                \n;\n\">\n                                         <p>Available: </p>\n                     </div>\n\n                         <p style=\"font-size: 30px;\n                                     color: #FFB900;\n                                     text-align: center;\n                                       text-shadow: 3px 3px black;\">\n                                     ${formatter.format(`${e.count}`)}\n               \n                         </p>\n                \n                   </div>\n\n\n                  `,\n            });\n        }\n\t\n      );\n    }\n  });\n}","flags":{"world":{"sizes":"bu ¥"},"core":{"sourceId":"Macro.5HrePh6zewWayAcp"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1671755868762,"modifiedTime":1677118319618,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"UopBWyjVc41YFpSg"}
{"name":"Leaning Tracker","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"icons/sundries/documents/document-sealed-signatures-red.webp","command":"const macro = this;\nconst myContent = `\n<form id=\"learning-form\">\n  <div id=\"learning-inputs\" style=\"display: grid; grid-template-columns: 160px auto 35px; grid-gap: 2px;\">\n    <div>Name</div>\n    <div>Skill</div>\n    <div>Time</div>\n  </div>\n  <div style=\"margin-top: 5px\">\n    <div id=\"learning-inputs\" style=\"display: grid; grid-template-columns: auto auto; grid-gap: 2px;\">\n\n    <button type=\"submit\">Save Changes</button>\n    <button type=\"delete\">Delete Player</button>\n  </div>\n\n  </div>\n</form>\n`;\nconst folderName = \"PC\";\nconst getFolder = game.folders.getName(folderName).contents;\nlet storedData = await macro.getFlag(\"world\", \"learning\") || {};\n\ngetFolder.forEach(function (currentObject) {\n  if (!storedData.hasOwnProperty(currentObject.name)) {\n    storedData[currentObject.name] = {\n      skill: \"\",\n      time: \"\"\n    };\n  }\n});\n\nawait macro.setFlag(\"world\", \"learning\", storedData.learning);\n\nfunction listeners(html, inputContainer) {\n  let form = html.find(\"#learning-form\")[0];\n  let deleteButton = html.find(\"#delete-button\")[0];\n\n  for (const name in storedData) {\n    let nameInput = document.createElement(\"input\");\n    let skillInput = document.createElement(\"input\");\n    let timeInput = document.createElement(\"input\");\n\n    nameInput.type = \"text\";\n    nameInput.value = name;\n    nameInput.disabled = true;\n    nameInput.style.width = \"100%\";\n\n    skillInput.type = \"text\";\n    skillInput.value = storedData[name].skill;\n    skillInput.placeholder = \"Enter a new skill\";\n    skillInput.style.width = \"100%\";\n\n    timeInput.type = \"number\";\n    timeInput.value = storedData[name].time;\n    timeInput.placeholder = \"Enter a new time\";\n    timeInput.style.width = \"100%\";\n    timeInput.style.textAlign = \"center\";\n\n    inputContainer.appendChild(nameInput);\n    inputContainer.appendChild(skillInput);\n    inputContainer.appendChild(timeInput);\n  }\n\n  form.addEventListener(\"submit\", function (event) {\n    event.preventDefault();\n    let inputs = inputContainer.querySelectorAll(\"input\");\n    let index = 0;\n    for (const name in storedData) {\n      storedData[name].skill = inputs[index + 1].value;\n      storedData[name].time = inputs[index + 2].value;\n      index += 3;\n    }\n\n    macro.setFlag(\"world\", \"learning\", storedData);\n  });\n        html.click( function (event) {\n\n       let user = GURPS.LastActor.name\nmacro.unsetFlag(\"world\", `learning.${user}`)\n\nChatMessage.create({ \n   speaker: { alias: \"GURPS Macro Learning Tracker\" } ,\n       content: \"Do not forget to move the actor out the folder\", \n\n});\n   \n\n   });\n}\n\nnew Dialog({\n  title: \"GURPS Learning Tracker\",\n  content: myContent,\n  buttons: {},\n  render: async (html) => listeners(html, html.find(\"#learning-inputs\")[0])\n}).render(true);\n\n\nmacro.unsetFlag(\"world\", `learning`)","flags":{"combat-utility-belt":{"macroTrigger":""},"world":{},"core":{"sourceId":"Macro.GuDvVvUTCTqABfTC"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1672183281959,"modifiedTime":1677118392390,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"fHQlD6Lep6Op0Xie"}
{"name":"Male Name","type":"script","scope":"global","author":"UdpG6vh58jnwUX8q","img":"worlds/japao/assets/samurai%20icon.webp","command":"const table = game.tables.getName(\"Nomes Masculinos\");\nfor(const token of canvas.tokens.controlled){\n  const draw = await table.draw({displayChat: false});\n  const name = draw.results[0].getChatText();\n  await token.document.update({name});\n  await token.actor.update({name, \"prototypeToken.name\": name});\n}","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.3ijvzR3OZkqepKxa"}},"_stats":{"systemId":"gurps","systemVersion":"0.15.31","coreVersion":"10.291","createdTime":1671843509589,"modifiedTime":1677118395154,"lastModifiedBy":"UdpG6vh58jnwUX8q"},"folder":null,"sort":0,"ownership":{"default":0,"UdpG6vh58jnwUX8q":3},"_id":"7Kl84lj1woydGMZl"}
